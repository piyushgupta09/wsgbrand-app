{"version":3,"file":"js/64.12425f48.js","mappings":"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","sources":["webpack://wsgbrand-app-v1/./src/modules/factory/pages/NewOrdersPage.vue","webpack://wsgbrand-app-v1/./src/modules/factory/pages/NewOrdersPage.vue?4714","webpack://wsgbrand-app-v1/./src/sections/NewOrdersSection.vue","webpack://wsgbrand-app-v1/./src/sections/NewOrdersSection.vue?ea50"],"sourcesContent":["<template>\n    <new-orders-section module=\"factory\" :links=\"[]\" />\n</template>\n\n<script>\nimport NewOrdersSection from '@/sections/NewOrdersSection.vue';\n\nexport default {\n    name: 'NewOrdersPage',\n    components: { NewOrdersSection },\n};\n</script>","import { render } from \"./NewOrdersPage.vue?vue&type=template&id=0b38459e\"\nimport script from \"./NewOrdersPage.vue?vue&type=script&lang=js\"\nexport * from \"./NewOrdersPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div class=\"font-title\">\n        <OrderFilters\n            :title=\"title\"\n            :filters=\"filters\"\n            :parties=\"parties\"\n            :statuses=\"statuses\"\n            @order-filter-updated=\"handleFiltersChange\" \n        />\n\n        <OrderTabs v-if=\"prefix === 'brand'\" :links=\"links\"/>\n\n        <div v-if=\"Object.keys(orders).length\">\n            <div v-for=\"(order, orderIndex) in orders\" :key=\"orderIndex\">\n                <ul class=\"list-group list-group-flush\">\n                    <OrderCard :order=\"order\" :type=\"prefix\" />\n                </ul>\n            </div>\n        </div>\n        <EmptyList v-else title=\"No Orders Available, try adjusting filters\" />\n        <OrderDetails :orders=\"orders\"  :type=\"prefix\" />\n    </div>\n</template>\n\n<script>\nimport Axios from '@/services/axios';\nimport EmptyList from '@/components/EmptyList.vue';\nimport OrderCard from '@/components/OrderCard.vue';\nimport OrderTabs from '@/components/OrderTabs.vue';\nimport OrderFilters from '@/components/OrderFilters.vue';\nimport OrderDetails from '@/components/OrderDetails.vue';\n\nexport default {\n    name: 'NewOrdersSection',\n    props: {\n        module: {\n            type: String,\n            required: true,\n        },\n        links: {\n            type: Array,\n            required: true,\n        },\n    },\n    components: {\n        OrderCard,\n        EmptyList,\n        OrderTabs,\n        OrderDetails,\n        OrderFilters,\n    },\n    data() {\n        return {\n            title: 'New Orders',\n            page: 1,\n            isFetching: false,\n            orders: [],\n            filters: {\n                date: '',\n                search: '',\n                selectedStatus: 'issued',\n                selectedParty: '',\n                perPage: 10,\n                sortBys: [\n                    { name: 'Latest Order', selected: true, value: 'created_at', order: 'desc'},\n                    { name: 'Oldest Order', selected: false, value: 'created_at', order: 'asc'},\n                    { name: 'Highest Quantity', selected: false, value: 'quantity', order: 'desc'},\n                    { name: 'Lowest Quantity', selected: false, value: 'quantity', order: 'asc'},\n                    { name: 'Nearest Delivery', selected: false, value: 'expected_at', order: 'asc'},\n                    { name: 'Furthest Delivery', selected: false, value: 'expected_at', order: 'desc'},\n                ],\n            },\n        };\n    },\n    mounted() {\n        window.addEventListener('scroll', this.handleScroll);\n        if (this.$route.query && this.$route.query.search) {\n            this.filters.search = this.$route.query.search || '';\n        }\n        if (this.$route.query && this.$route.query.status) {\n            this.filters.selectedStatus = this.$route.query.status || '';\n        }\n        this.loadMore();\n    },\n    unmounted() {\n        window.removeEventListener('scroll', this.handleScroll);\n    },\n    watch: {\n        filters: {\n            handler() {\n                console.log('Filters changed');\n                this.page = 1;\n                this.orders = [];\n                this.loadMore();\n            },\n            deep: true,\n        },\n    },\n    computed: {\n        cardType() {\n            return this.$store.getters['authy/getPrefix'] === 'brand' ? 'brand' : 'party';\n        },\n        parties() {\n            if (this.orders && !this.orders.length) {\n                return [];\n                \n            }\n            const localOrders = this.orders;\n            const uniquePartiesMap = {};\n            const uniqueParties = [];\n\n            if (localOrders) {\n                localOrders.forEach(order => {\n                    // Use sid as the key in the map.\n                    const sid = order.party.sid;\n                    // If this sid hasn't been added to uniqueParties, add it.\n                    if (!uniquePartiesMap[sid]) {\n                        uniqueParties.push(order.party);\n                        uniquePartiesMap[sid] = true; // Mark this sid as added.\n                    }\n                });\n            }\n            \n            return uniqueParties;\n        },\n        statuses() {\n            return [\n                { text: 'Issued', value: 'issued' },\n                { text: 'Accepted', value: 'accepted' },\n                { text: 'Rejected', value: 'rejected' },\n            ];\n        },\n        prefix() {\n            return this.$store.getters['authy/getPrefix'];\n        },\n    },\n    methods: {\n        handleScroll() {\n            const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n            if (clientHeight + scrollTop >= scrollHeight - 5) { // Check if near bottom\n                this.loadMore();\n            }\n        },\n        loadMore() {\n            if (this.isFetching)\n                return;\n            this.isFetching = true;\n\n            const params = new URLSearchParams({\n                page: this.page,\n                search: this.filters.search,\n                status: this.filters.selectedStatus,\n                party: this.filters.selectedParty,\n            });\n\n            // Assuming you have only one selected sort option at a time\n            const selectedSortOption = this.filters.sortBys.find(option => option.selected);\n            if (selectedSortOption) {\n                params.append('sortby', selectedSortOption.value);\n                params.append('sortorder', selectedSortOption.order);\n            }\n\n            \n            Axios.get(`orders?${params}&perpage=${this.filters.perPage}`).then(response => {\n                    if (response.data.status === 'ok') {\n                        this.orders = [...this.orders, ...response.data.data.data];\n                        this.page++;\n                        this.isFetching = false;\n                    }\n                    else if (response.data.status === 'error') {\n                        this.isFetching = false;\n                        alert(response.data.message);\n                    }\n                    else {\n                        this.isFetching = false;\n                        alert('Something went wrong! Please try again');\n                    }\n                }).catch((error) => {\n                    this.isFetching = false;\n                    console.log(error);\n                    alert('Something went wrong! Please try again');\n                });\n        },\n        handleFiltersChange(filters) {\n            this.filters = filters;\n        },\n        resetFilters() {\n            this.filters = {\n                date: '',\n                search: '',\n                selectedStatus: 'issued',\n                selectedParty: '',\n                perPage: 10,\n                sortBys: [\n                    { name: 'Latest Order', selected: true, value: 'created_at', order: 'desc'},\n                    { name: 'Oldest Order', selected: false, value: 'created_at', order: 'asc'},\n                    { name: 'Highest Quantity', selected: false, value: 'quantity', order: 'desc'},\n                    { name: 'Lowest Quantity', selected: false, value: 'quantity', order: 'asc'},\n                    { name: 'Nearest Delivery', selected: false, value: 'expected_at', order: 'asc'},\n                    { name: 'Furthest Delivery', selected: false, value: 'expected_at', order: 'desc'},\n                ],\n            };\n        },\n    },\n}\n</script>\n  ","import { render } from \"./NewOrdersSection.vue?vue&type=template&id=9f64d492\"\nimport script from \"./NewOrdersSection.vue?vue&type=script&lang=js\"\nexport * from \"./NewOrdersSection.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createBlock","_component_new_orders_section","module","links","name","components","NewOrdersSection","__exports__","render","class","key","_createElementBlock","_hoisted_1","_createVNode","_component_OrderFilters","title","$data","filters","parties","$options","statuses","onOrderFilterUpdated","handleFiltersChange","prefix","_component_OrderTabs","$props","_createCommentVNode","Object","keys","orders","length","_hoisted_2","_Fragment","_renderList","order","orderIndex","_createElementVNode","_hoisted_3","_component_OrderCard","type","_component_EmptyList","_component_OrderDetails","props","String","required","Array","OrderCard","EmptyList","OrderTabs","OrderDetails","OrderFilters","data","page","isFetching","date","search","selectedStatus","selectedParty","perPage","sortBys","selected","value","mounted","window","addEventListener","this","handleScroll","$route","query","status","loadMore","unmounted","removeEventListener","watch","handler","console","log","deep","computed","cardType","$store","getters","localOrders","uniquePartiesMap","uniqueParties","forEach","sid","party","push","text","methods","scrollTop","scrollHeight","clientHeight","document","documentElement","params","URLSearchParams","selectedSortOption","find","option","append","Axios","get","then","response","alert","message","catch","error","resetFilters"],"sourceRoot":""}