{"version":3,"file":"js/5612.bc9c01ef.js","mappings":"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","sources":["webpack://wsgbrand-app-v1/./src/modules/brandy/pages/purchases/PosPage.vue","webpack://wsgbrand-app-v1/./src/modules/brandy/pages/purchases/PosPage.vue?5680","webpack://wsgbrand-app-v1/./src/sections/NewOrdersSection.vue","webpack://wsgbrand-app-v1/./src/sections/NewOrdersSection.vue?ea50"],"sourcesContent":["<template>\n    <div class=\"font-title\">\n        <new-orders-section module=\"brand\" :links=\"links\" />\n    </div>\n</template>\n  \n<script>\nimport NewOrdersSection from '@/sections/NewOrdersSection.vue';\n\nexport default {\n    name: 'PosPage',\n    components: { NewOrdersSection },\n    data() {\n        return {\n            links: [\n                { name: 'BrandPos', label: 'PO' },\n                { name: 'BrandIncomings', label: 'Inwards' },\n                { name: 'BrandPurchases', label: 'Bills' }\n            ],\n        };\n    },\n}\n</script>\n","import { render } from \"./PosPage.vue?vue&type=template&id=f81f0422\"\nimport script from \"./PosPage.vue?vue&type=script&lang=js\"\nexport * from \"./PosPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div class=\"font-title\">\n        <OrderFilters\n            :title=\"title\"\n            :filters=\"filters\"\n            :parties=\"parties\"\n            :statuses=\"statuses\"\n            @order-filter-updated=\"handleFiltersChange\" \n        />\n\n        <OrderTabs v-if=\"prefix === 'brand'\" :links=\"links\"/>\n\n        <div v-if=\"Object.keys(orders).length\">\n            <div v-for=\"(order, orderIndex) in orders\" :key=\"orderIndex\">\n                <ul class=\"list-group list-group-flush\">\n                    <OrderCard :order=\"order\" :type=\"prefix\" />\n                </ul>\n            </div>\n        </div>\n        <EmptyList v-else title=\"No Orders Available, try adjusting filters\" />\n        <OrderDetails :orders=\"orders\"  :type=\"prefix\" />\n    </div>\n</template>\n\n<script>\nimport Axios from '@/services/axios';\nimport EmptyList from '@/components/EmptyList.vue';\nimport OrderCard from '@/components/OrderCard.vue';\nimport OrderTabs from '@/components/OrderTabs.vue';\nimport OrderFilters from '@/components/OrderFilters.vue';\nimport OrderDetails from '@/components/OrderDetails.vue';\n\nexport default {\n    name: 'NewOrdersSection',\n    props: {\n        module: {\n            type: String,\n            required: true,\n        },\n        links: {\n            type: Array,\n            required: true,\n        },\n    },\n    components: {\n        OrderCard,\n        EmptyList,\n        OrderTabs,\n        OrderDetails,\n        OrderFilters,\n    },\n    data() {\n        return {\n            title: 'New Orders',\n            page: 1,\n            isFetching: false,\n            orders: [],\n            filters: {\n                date: '',\n                search: '',\n                selectedStatus: 'issued',\n                selectedParty: '',\n                perPage: 10,\n                sortBys: [\n                    { name: 'Latest Order', selected: true, value: 'created_at', order: 'desc'},\n                    { name: 'Oldest Order', selected: false, value: 'created_at', order: 'asc'},\n                    { name: 'Highest Quantity', selected: false, value: 'quantity', order: 'desc'},\n                    { name: 'Lowest Quantity', selected: false, value: 'quantity', order: 'asc'},\n                    { name: 'Nearest Delivery', selected: false, value: 'expected_at', order: 'asc'},\n                    { name: 'Furthest Delivery', selected: false, value: 'expected_at', order: 'desc'},\n                ],\n            },\n        };\n    },\n    mounted() {\n        window.addEventListener('scroll', this.handleScroll);\n        if (this.$route.query && this.$route.query.search) {\n            this.filters.search = this.$route.query.search || '';\n        }\n        if (this.$route.query && this.$route.query.status) {\n            this.filters.selectedStatus = this.$route.query.status || '';\n        }\n        this.loadMore();\n    },\n    unmounted() {\n        window.removeEventListener('scroll', this.handleScroll);\n    },\n    watch: {\n        filters: {\n            handler() {\n                console.log('Filters changed');\n                this.page = 1;\n                this.orders = [];\n                this.loadMore();\n            },\n            deep: true,\n        },\n    },\n    computed: {\n        cardType() {\n            return this.$store.getters['authy/getPrefix'] === 'brand' ? 'brand' : 'party';\n        },\n        parties() {\n            if (this.orders && !this.orders.length) {\n                return [];\n                \n            }\n            const localOrders = this.orders;\n            const uniquePartiesMap = {};\n            const uniqueParties = [];\n\n            if (localOrders) {\n                localOrders.forEach(order => {\n                    // Use sid as the key in the map.\n                    const sid = order.party.sid;\n                    // If this sid hasn't been added to uniqueParties, add it.\n                    if (!uniquePartiesMap[sid]) {\n                        uniqueParties.push(order.party);\n                        uniquePartiesMap[sid] = true; // Mark this sid as added.\n                    }\n                });\n            }\n            \n            return uniqueParties;\n        },\n        statuses() {\n            return [\n                { text: 'Issued', value: 'issued' },\n                { text: 'Accepted', value: 'accepted' },\n                { text: 'Rejected', value: 'rejected' },\n            ];\n        },\n        prefix() {\n            return this.$store.getters['authy/getPrefix'];\n        },\n    },\n    methods: {\n        handleScroll() {\n            const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n            if (clientHeight + scrollTop >= scrollHeight - 5) { // Check if near bottom\n                this.loadMore();\n            }\n        },\n        loadMore() {\n            if (this.isFetching)\n                return;\n            this.isFetching = true;\n\n            const params = new URLSearchParams({\n                page: this.page,\n                search: this.filters.search,\n                status: this.filters.selectedStatus,\n                party: this.filters.selectedParty,\n            });\n\n            // Assuming you have only one selected sort option at a time\n            const selectedSortOption = this.filters.sortBys.find(option => option.selected);\n            if (selectedSortOption) {\n                params.append('sortby', selectedSortOption.value);\n                params.append('sortorder', selectedSortOption.order);\n            }\n\n            \n            Axios.get(`orders?${params}&perpage=${this.filters.perPage}`).then(response => {\n                    if (response.data.status === 'ok') {\n                        this.orders = [...this.orders, ...response.data.data.data];\n                        this.page++;\n                        this.isFetching = false;\n                    }\n                    else if (response.data.status === 'error') {\n                        this.isFetching = false;\n                        alert(response.data.message);\n                    }\n                    else {\n                        this.isFetching = false;\n                        alert('Something went wrong! Please try again');\n                    }\n                }).catch((error) => {\n                    this.isFetching = false;\n                    console.log(error);\n                    alert('Something went wrong! Please try again');\n                });\n        },\n        handleFiltersChange(filters) {\n            this.filters = filters;\n        },\n        resetFilters() {\n            this.filters = {\n                date: '',\n                search: '',\n                selectedStatus: 'issued',\n                selectedParty: '',\n                perPage: 10,\n                sortBys: [\n                    { name: 'Latest Order', selected: true, value: 'created_at', order: 'desc'},\n                    { name: 'Oldest Order', selected: false, value: 'created_at', order: 'asc'},\n                    { name: 'Highest Quantity', selected: false, value: 'quantity', order: 'desc'},\n                    { name: 'Lowest Quantity', selected: false, value: 'quantity', order: 'asc'},\n                    { name: 'Nearest Delivery', selected: false, value: 'expected_at', order: 'asc'},\n                    { name: 'Furthest Delivery', selected: false, value: 'expected_at', order: 'desc'},\n                ],\n            };\n        },\n    },\n}\n</script>\n  ","import { render } from \"./NewOrdersSection.vue?vue&type=template&id=9f64d492\"\nimport script from \"./NewOrdersSection.vue?vue&type=script&lang=js\"\nexport * from \"./NewOrdersSection.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_new_orders_section","module","links","$data","name","components","NewOrdersSection","data","label","__exports__","render","key","_component_OrderFilters","title","filters","parties","$options","statuses","onOrderFilterUpdated","handleFiltersChange","prefix","_createBlock","_component_OrderTabs","$props","_createCommentVNode","Object","keys","orders","length","_hoisted_2","_Fragment","_renderList","order","orderIndex","_createElementVNode","_hoisted_3","_component_OrderCard","type","_component_EmptyList","_component_OrderDetails","props","String","required","Array","OrderCard","EmptyList","OrderTabs","OrderDetails","OrderFilters","page","isFetching","date","search","selectedStatus","selectedParty","perPage","sortBys","selected","value","mounted","window","addEventListener","this","handleScroll","$route","query","status","loadMore","unmounted","removeEventListener","watch","handler","console","log","deep","computed","cardType","$store","getters","localOrders","uniquePartiesMap","uniqueParties","forEach","sid","party","push","text","methods","scrollTop","scrollHeight","clientHeight","document","documentElement","params","URLSearchParams","selectedSortOption","find","option","append","Axios","get","then","response","alert","message","catch","error","resetFilters"],"sourceRoot":""}