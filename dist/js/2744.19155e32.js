"use strict";(self["webpackChunkwsgbrand_app_v1"]=self["webpackChunkwsgbrand_app_v1"]||[]).push([[2744],{9176:function(e,t,s){s.d(t,{c:function(){return f}});var a=s(4108),l=s(9096);const r={class:"list-group list-group-flush border-bottom py-5"},c={class:"list-group-item d-flex flex-column align-items-center"},n=(0,a.QD)("div",{class:"d-flex justify-content-center align-items-center rounded-circle border bg-light",style:{height:"60px",width:"60px"}},[(0,a.QD)("i",{class:"bi bi-funnel text-secondary fs-1",style:{opacity:"60%"}})],-1),i={class:"d-flex flex-fill flex-column px-3 mt-3"},o={class:"fw-bold font-title mb-0"};function d(e,t,s,d,u,h){return(0,a.Wz)(),(0,a.An)("div",r,[(0,a.QD)("div",c,[n,(0,a.QD)("div",i,[(0,a.QD)("p",o,(0,l.WA)(s.title),1)])])])}var u={name:"EmptyList",props:["title"]},h=s(4100);const p=(0,h.c)(u,[["render",d]]);var f=p},60:function(e,t,s){s.d(t,{c:function(){return R}});var a=s(4108),l=s(9096),r=s(7764);const c={class:"border-bottom bg-body-tertiary"},n={class:"navbar navbar-expand py-1"},i={class:"navbar-collapse d-flex align-items-center me-3"},o={class:"d-flex align-items-center"},d=(0,a.QD)("i",{class:"bi bi-chevron-left"},null,-1),u={class:"mb-0"},h={class:"navbar-nav ms-auto align-items-center"},p=(0,a.QD)("li",{class:"nav-item"},[(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasSearch","aria-expanded":"false","aria-controls":"offcanvasSearch"},[(0,a.QD)("i",{class:"bi bi-search"})])],-1),f={key:0,class:"nav-item"},b=(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasFilter","aria-expanded":"false","aria-controls":"offcanvasFilter"},[(0,a.QD)("i",{class:"bi bi-funnel"})],-1),m=[b],g={key:1,class:"nav-item"},v=(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasSortBy","aria-expanded":"false","aria-controls":"offcanvasSortBy"},[(0,a.QD)("i",{class:"bi bi-sort-up-alt"})],-1),y=[v],D={class:"nav-item"},Q={class:"collapse",id:"offcanvasSearch"},A={class:"form-floating mx-2 mb-2"},P=(0,a.QD)("label",{for:"floatingInput"},"Search by name or code",-1),x={class:"collapse",id:"offcanvasFilter"},k={class:"card card-body"},W=(0,a.QD)("option",{value:"",selected:"",disabled:""},"Filter By Fabricator",-1),S=["value"],w={key:1,class:"mb-2 fw-bold"},F={key:2,class:"d-flex flex-wrap w-100 border border-end-0 border-bottom-0"},z=["id","value","checked","onChange"],B=["for"],C=(0,a.QD)("br",null,null,-1),I={class:"btn-group w-100 mt-4"},_={class:"collapse",id:"offcanvasSortBy"},E={key:0,class:"card card-body"},L=(0,a.QD)("p",{class:"mb-2 fw-bold"},"Sort by",-1),O={class:"d-flex flex-wrap border border-end-0"},M=["id","checked","onChange"],j=["for"],$=(0,a.QD)("br",null,null,-1);function q(e,t,s,b,v,q){const K=(0,a.E1)("router-link");return(0,a.Wz)(),(0,a.An)("div",c,[(0,a.QD)("nav",n,[(0,a.QD)("div",i,[(0,a.QD)("div",o,[(0,a.K2)(K,{class:"btn",to:{name:q.myDashboard}},{default:(0,a.Ql)((()=>[d])),_:1},8,["to"]),(0,a.QD)("h6",u,(0,l.WA)(s.title),1)]),(0,a.QD)("ul",h,[p,s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("li",f,m)):(0,a.g1)("",!0),s.filters&&s.filters.sortBys&&s.filters.sortBys.length?((0,a.Wz)(),(0,a.An)("li",g,y)):(0,a.g1)("",!0),(0,a.QD)("li",D,[(0,a.QD)("button",{class:"btn btn-outline-dark rounded-0 btn-sm px-1 py-0 ms-2",onClick:t[0]||(t[0]=(...e)=>q.updatePerPage&&q.updatePerPage(...e))},(0,l.WA)(v.perPage),1)])])])]),(0,a.QD)("div",Q,[(0,a.QD)("div",A,[(0,a.wt)((0,a.QD)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>v.search=e),type:"search",class:"form-control rounded-0",placeholder:"Search Stocks",onChange:t[2]||(t[2]=(...e)=>q.emitFilters&&q.emitFilters(...e))},null,544),[[r.Og,v.search,void 0,{lazy:!0}]]),P])]),(0,a.QD)("div",x,[(0,a.QD)("div",k,[q.isBrand?(0,a.wt)(((0,a.Wz)(),(0,a.An)("select",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>v.selectedParty=e),onChange:t[4]||(t[4]=(...e)=>q.applyFilters&&q.applyFilters(...e)),class:"form-select py-3 mb-3","aria-label":"Filter By Party"},[W,((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.parties,((e,t)=>((0,a.Wz)(),(0,a.An)("option",{key:t,value:e.sid},(0,l.WA)(e.name),9,S)))),128))],544)),[[r.Ip,v.selectedParty]]):(0,a.g1)("",!0),s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("p",w,"Filter by status")):(0,a.g1)("",!0),s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("div",F,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.statuses,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{class:"flex-fill border-end border-bottom",key:t},[(0,a.QD)("input",{type:"checkbox",class:"btn-check",id:"filterby"+q.getCheckboxId(t),autocomplete:"off",value:e.value,checked:e.value===v.selectedStatus,onChange:t=>q.updateSelectedStatus(e.value)},null,40,z),(0,a.QD)("label",{class:"btn btn-outline-dark rounded-0 border-0 w-100",for:"filterby"+q.getCheckboxId(t)},(0,l.WA)(e.text),9,B),C])))),128))])):(0,a.g1)("",!0),(0,a.QD)("div",I,[(0,a.QD)("button",{onClick:t[5]||(t[5]=(...e)=>q.resetFilters&&q.resetFilters(...e)),class:"btn btn-outline-dark"},"Reset")])])]),(0,a.QD)("div",_,[v.localSortBys&&v.localSortBys.length?((0,a.Wz)(),(0,a.An)("div",E,[L,(0,a.QD)("div",O,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(v.localSortBys,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{class:"flex-fill border-end",key:t},[(0,a.QD)("input",{type:"checkbox",class:"btn-check",id:"sortby"+q.getCheckboxId(t),autocomplete:"off",checked:e.selected,onChange:e=>q.updateSelectedSortBy(t)},null,40,M),(0,a.QD)("label",{class:"btn btn-outline-dark rounded-0 border-0 w-100",for:"sortby"+q.getCheckboxId(t)},(0,l.WA)((e.selected,e.name)),9,j),$])))),128))])])):(0,a.g1)("",!0)])])}var K={name:"OrderFilters",emits:["order-filter-updated"],props:{title:{type:String,default:"Products"},filters:{type:Object,default:()=>({})},parties:{type:Array,default:()=>[]},statuses:{type:Array,default:()=>[]}},data(){return{perPage:this.filters.perPage||10,search:this.filters.search||"",localSortBys:this.filters.sortBys?[...this.filters.sortBys]:[],selectedParty:this.filters.selectedParty||"",selectedStatus:this.filters.selectedStatus||""}},methods:{updatePerPage(){this.perPage>90?this.perPage=10:this.perPage+=10,this.applyFilters()},applyFilters(){this.$emit("order-filter-updated",{perPage:this.perPage,search:this.search,sortBys:this.localSortBys,selectedParty:this.selectedParty,selectedStatus:this.selectedStatus})},resetFilters(){this.perPage=10,this.search="",this.localSortBys=[...this.filters.sortBys],this.selectedParty="",this.selectedStatus="",this.applyFilters()},emitFilters(){this.applyFilters()},getCheckboxId(e){return`btn-check-outlined-${e}`},updateSelectedStatus(e){this.selectedStatus=this.selectedStatus===e?"":e,this.applyFilters()},updateSelectedSortBy(e){this.localSortBys=this.localSortBys.map(((t,s)=>(t.selected=s===e,t))),this.applyFilters()},capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}},computed:{isBrand(){return"brand"===this.$store.getters["authy/getPrefix"]},myDashboard(){const e=this.capitalizeFirstLetter(this.$store.getters["authy/getPrefix"]);return`${e}Dashboard`}}},U=s(4100);const T=(0,U.c)(K,[["render",q]]);var R=T},1256:function(e,t,s){s.d(t,{c:function(){return d}});var a=s(4108),l=s(9096);const r={class:"nav nav-pills nav-fill border-bottom"};function c(e,t,s,c,n,i){const o=(0,a.E1)("router-link");return(0,a.Wz)(),(0,a.An)("ul",r,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.links,(e=>((0,a.Wz)(),(0,a.An)("li",{class:"nav-item",key:e.name},[(0,a.K2)(o,{to:{name:e.name},class:(0,l.WN)(["nav-link rounded-0 fw-500 ls-1 small text-bg-light",{"active text-white":i.isLinkActive(e.name)}])},{default:(0,a.Ql)((()=>[(0,a.mY)((0,l.WA)(e.label),1)])),_:2},1032,["to","class"])])))),128))])}var n={name:"OrderTabs",props:{links:{type:Array,required:!0}},methods:{isLinkActive(e){return this.$route.name===e}}},i=s(4100);const o=(0,i.c)(n,[["render",c],["__scopeId","data-v-600df884"]]);var d=o},736:function(e,t,s){s.d(t,{c:function(){return Q}});var a=s(4108),l=s(9096);const r={key:0,class:"card rounded-0 mb-2"},c={class:"d-flex border-bottom"},n=["src","data-bs-url"],i={class:"flex-fill d-flex flex-column justify-content-between"},o={class:"p-2"},d={class:"d-flex justify-content-between"},u={class:"fw-bold"},h={class:"fw-bold"},p={class:"d-flex justify-content-between"},f={class:""},b={class:""},m=["data-bs-purchasedocId"];function g(e,t,s,g,v,y){return s.purchase&&s.purchase.groups&&Object.entries(s.purchase.groups).length?((0,a.Wz)(),(0,a.An)("div",r,[(0,a.QD)("div",c,[s.purchase.party?((0,a.Wz)(),(0,a.An)("img",{key:0,src:s.purchase.party.image,class:"of-cover w-80p","data-bs-toggle":"modal","data-bs-target":"#imagePreviewModal","data-bs-url":s.purchase.party.preview},null,8,n)):(0,a.g1)("",!0),(0,a.QD)("div",i,[(0,a.QD)("div",o,[(0,a.QD)("div",d,[(0,a.QD)("span",u,"#"+(0,l.WA)(s.purchase.doc_id),1),(0,a.QD)("span",h,(0,l.WA)(s.purchase.quantity.toLocaleString())+" pcs.",1)]),(0,a.QD)("div",p,[(0,a.QD)("span",f,(0,l.WA)(s.purchase.doc_date),1),(0,a.QD)("span",b,"Rs. "+(0,l.WA)(s.purchase.total.toLocaleString()),1)]),(0,a.QD)("button",{class:"btn btn-sm btn-outline-dark w-100 mt-2","data-bs-toggle":"offcanvas","data-bs-target":"#purchaseInfoModal","data-bs-purchasedocId":s.purchase.doc_id,"aria-controls":"purchaseInfoModal"}," Show Products ",8,m)])])])])):(0,a.g1)("",!0)}var v={name:"PurchaseCard",props:["purchase"]},y=s(4100);const D=(0,y.c)(v,[["render",g]]);var Q=D},9312:function(e,t,s){s.d(t,{c:function(){return I}});var a=s(4108),l=s(9096);const r={key:0,class:"offcanvas offcanvas-end",tabindex:"-1",id:"purchaseInfoModal","aria-labelledby":"purchaseInfoModalLabel"},c={class:"offcanvas-header d-flex justify-content-between align-items-center bg-light border-bottom"},n={class:"d-flex flex-fill justify-content-start gap-2 align-items-center"},i=(0,a.QD)("i",{class:"bi bi-chevron-left pe-2","data-bs-dismiss":"offcanvas","data-bs-target":"#purchaseInfoModal","aria-label":"Close"},null,-1),o={key:0,class:"text-capitalize fw-500",id:"purchaseInfoModal"},d={class:"fw-500"},u={class:"offcanvas-body p-2"},h={class:"card-header p-0 d-flex justify-content-between overflow-hidden"},p={class:"d-flex align-items-center w-100"},f=["src","data-bs-url"],b=["href"],m={class:"fw-500"},g={class:"small"},v={class:"me-2 d-flex flex-column align-items-end"},y={class:"fw-500"},D={class:"small"},Q=["id"],A={class:"table table-sm table-striped table-borderless mb-0"},P=(0,a.QD)("thead",null,[(0,a.QD)("tr",null,[(0,a.QD)("th",{scope:"col",class:"ps-2 small"},"Color"),(0,a.QD)("th",{scope:"col",class:"small"},"Size"),(0,a.QD)("th",{scope:"col",class:"small text-end"},"Qty"),(0,a.QD)("th",{scope:"col",class:"small text-end"},"Rate"),(0,a.QD)("th",{scope:"col",class:"small text-end pe-2"},"Amt")])],-1),x={class:"ps-2 small"},k={class:"small"},W={class:"small text-end"},S={class:"small text-end"},w={class:"small text-end pe-2"};function F(e,t,s,F,z,B){return z.activePurchase?((0,a.Wz)(),(0,a.An)("div",r,[(0,a.QD)("div",c,[(0,a.QD)("div",n,[i,z.activePurchase.party&&z.activePurchase.party.name?((0,a.Wz)(),(0,a.An)("span",o,(0,l.WA)(z.activePurchase.party.name),1)):(0,a.g1)("",!0)]),(0,a.QD)("span",d,"₹ "+(0,l.WA)(z.activePurchase.total),1)]),(0,a.QD)("div",u,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(z.activePurchase.groups,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{class:"card mb-2",key:t},[(0,a.QD)("div",h,[(0,a.QD)("div",p,[(0,a.QD)("img",{src:e.image,class:"of-cover h-60p br-tl p-2","data-bs-toggle":"modal","data-bs-target":"#ledgerImageModal","data-bs-url":e.preview},null,8,f),(0,a.QD)("div",{class:"flex-fill d-flex flex-column","data-bs-toggle":"collapse",href:"#collapsePurchase"+z.activePurchase.doc_id+"-"+t,role:"button","aria-expanded":"false","aria-controls":"collapseExample"},[(0,a.QD)("span",m,"#"+(0,l.WA)(e.product_code),1),(0,a.QD)("span",g,(0,l.WA)(e.product_name),1)],8,b),(0,a.QD)("div",v,[(0,a.QD)("span",y,(0,l.WA)(e.quantity)+" pcs",1),(0,a.QD)("span",D,"₹ "+(0,l.WA)(e.amount),1)])])]),(0,a.QD)("div",{class:"collapse",id:"collapsePurchase"+z.activePurchase.doc_id+"-"+t},[(0,a.QD)("table",A,[P,(0,a.QD)("tbody",null,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(e.items,((e,t)=>((0,a.Wz)(),(0,a.An)("tr",{key:t},[(0,a.QD)("td",x,(0,l.WA)(e.option),1),(0,a.QD)("td",k,(0,l.WA)(e.range),1),(0,a.QD)("td",W,(0,l.WA)(e.billed_quantity),1),(0,a.QD)("td",S,(0,l.WA)(e.rate),1),(0,a.QD)("td",w,(0,l.WA)(e.amount),1)])))),128))])])],8,Q)])))),128))])])):(0,a.g1)("",!0)}var z={name:"PurchaseCardDetail",props:["purchases"],data(){return{activePurchase:{}}},async mounted(){this.loadActivePurchase()},methods:{loadActivePurchase(){const e=document.getElementById("purchaseInfoModal");e&&e.addEventListener("show.bs.offcanvas",(e=>{const t=e.relatedTarget,s=t.getAttribute("data-bs-purchasedocId");console.log("testtest"+this.activePurchase),this.activePurchase=this.purchases.find((e=>e.doc_id===s))}))}}},B=s(4100);const C=(0,B.c)(z,[["render",F]]);var I=C},7984:function(e,t,s){s.d(t,{c:function(){return g}});var a=s(4108),l=s(7764);const r={class:"font-title"},c={key:0,class:"list-group list-group-flush"};function n(e,t,s,n,i,o){const d=(0,a.E1)("OrderFilters"),u=(0,a.E1)("OrderTabs"),h=(0,a.E1)("PurchaseCard"),p=(0,a.E1)("PurchaseCardDetail"),f=(0,a.E1)("EmptyList");return(0,a.Wz)(),(0,a.An)("div",r,[(0,a.K2)(d,{title:i.title,filters:i.filters,parties:o.parties,onOrderFilterUpdated:o.handleFiltersChange},null,8,["title","filters","parties","onOrderFilterUpdated"]),(0,a.K2)(u,{links:s.links},null,8,["links"]),Object.keys(o.filteredPurchases).length?((0,a.Wz)(),(0,a.An)("ul",c,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(o.filteredPurchases,((e,t)=>((0,a.Wz)(),(0,a.An)("li",{class:"list-group-item p-0",key:t},[(0,a.K2)(l.Ox,{name:"slide",mode:"out-in"},{default:(0,a.Ql)((()=>[(0,a.K2)(h,{purchase:e},null,8,["purchase"])])),_:2},1024)])))),128)),(0,a.K2)(p,{purchases:o.filteredPurchases},null,8,["purchases"])])):((0,a.Wz)(),(0,a.Az)(f,{key:1,title:"No Purchase Available"}))])}s(3248),s(2168),s(5104),s(8312);var i=s(6376),o=s(9176),d=s(1256),u=s(736),h=s(60),p=s(9312),f={name:"PurchaseBillsSection",props:{module:{type:String,required:!0},links:{type:Array,required:!0}},components:{EmptyList:o.c,OrderTabs:d.c,PurchaseCard:u.c,OrderFilters:h.c,PurchaseCardDetail:p.c},data(){return{title:"Purchases",page:1,isFetching:!1,purchases:[],filters:{date:"",search:"",selectedStatus:"received",selectedParty:"",perPage:10,sortBys:[{name:"Latest Bill",selected:!0,value:"created_at",order:"desc"},{name:"Oldest Bill",selected:!1,value:"created_at",order:"asc"},{name:"Highest Amount",selected:!1,value:"total",order:"desc"},{name:"Lowest Amount",selected:!1,value:"total",order:"asc"},{name:"Biggest Volume",selected:!1,value:"quantity",order:"asc"},{name:"Smallest Volume",selected:!1,value:"quantity",order:"desc"}]}}},watch:{filters:{handler(){console.log("Filters changed"),this.page=1,this.purchases=[],this.loadMore()},deep:!0}},mounted(){this.loadMore(),window.addEventListener("scroll",this.handleScroll),this.title="brand"===this.$store.getters["authy/getPrefix"]?"Purchases":"Sales"},unmounted(){window.removeEventListener("scroll",this.handleScroll)},computed:{parties(){const e=this.purchases,t={},s=[];return e&&e.forEach((e=>{const a=e.party.sid;t[a]||(s.push(e.party),t[a]=!0)})),s},filteredPurchases(){let e=this.purchases;return e}},methods:{handleScroll(){const{scrollTop:e,scrollHeight:t,clientHeight:s}=document.documentElement;s+e>=t-5&&this.loadMore()},loadMore(){if(this.isFetching)return;this.isFetching=!0;const e=new URLSearchParams({page:this.page,search:this.filters.search,status:this.filters.selectedStatus,party:this.filters.selectedParty}),t=this.filters.sortBys.find((e=>e.selected));t&&(e.append("sortby",t.value),e.append("sortorder",t.order)),i.c.get(`purchases?${e}&perpage=${this.filters.perPage}`).then((e=>{"ok"===e.data.status?(this.purchases=[...this.purchases,...e.data.data.data],this.page++,this.isFetching=!1):"error"===e.data.status?(this.isFetching=!1,alert(e.data.message)):(this.isFetching=!1,alert("Something went wrong! Please try again"))})).catch((e=>{this.isFetching=!1,console.log(e),alert("Something went wrong! Please try again")}))},handleFiltersChange(e){this.filters=e}}},b=s(4100);const m=(0,b.c)(f,[["render",n]]);var g=m}}]);
//# sourceMappingURL=2744.19155e32.js.map