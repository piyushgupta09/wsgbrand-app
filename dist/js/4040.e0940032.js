"use strict";(self["webpackChunkwsgbrand_app_v1"]=self["webpackChunkwsgbrand_app_v1"]||[]).push([[4040],{60:function(e,t,s){s.d(t,{c:function(){return H}});var a=s(4108),r=s(9096),l=s(7764);const i={class:"border-bottom bg-body-tertiary"},n={class:"navbar navbar-expand py-1"},c={class:"navbar-collapse d-flex align-items-center me-3"},o={class:"d-flex align-items-center"},d=(0,a.QD)("i",{class:"bi bi-chevron-left"},null,-1),h={class:"mb-0"},p={class:"navbar-nav ms-auto align-items-center"},u=(0,a.QD)("li",{class:"nav-item"},[(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasSearch","aria-expanded":"false","aria-controls":"offcanvasSearch"},[(0,a.QD)("i",{class:"bi bi-search"})])],-1),f={key:0,class:"nav-item"},b=(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasFilter","aria-expanded":"false","aria-controls":"offcanvasFilter"},[(0,a.QD)("i",{class:"bi bi-funnel"})],-1),y=[b],g={key:1,class:"nav-item"},m=(0,a.QD)("button",{class:"btn fs-5 border-0","data-bs-toggle":"collapse","data-bs-target":"#offcanvasSortBy","aria-expanded":"false","aria-controls":"offcanvasSortBy"},[(0,a.QD)("i",{class:"bi bi-sort-up-alt"})],-1),v=[m],k={class:"nav-item"},D={class:"collapse",id:"offcanvasSearch"},S={class:"form-floating mx-2 mb-2"},F=(0,a.QD)("label",{for:"floatingInput"},"Search by name or code",-1),Q={class:"collapse",id:"offcanvasFilter"},A={class:"card card-body"},P=(0,a.QD)("option",{value:"",selected:"",disabled:""},"Filter By Fabricator",-1),x=["value"],w={key:1,class:"mb-2 fw-bold"},W={key:2,class:"d-flex flex-wrap w-100 border border-end-0 border-bottom-0"},z=["id","value","checked","onChange"],B=["for"],C=(0,a.QD)("br",null,null,-1),O={class:"btn-group w-100 mt-4"},E={class:"collapse",id:"offcanvasSortBy"},$={key:0,class:"card card-body"},L=(0,a.QD)("p",{class:"mb-2 fw-bold"},"Sort by",-1),_={class:"d-flex flex-wrap border border-end-0"},I=["id","checked","onChange"],q=["for"],K=(0,a.QD)("br",null,null,-1);function U(e,t,s,b,m,U){const M=(0,a.E1)("router-link");return(0,a.Wz)(),(0,a.An)("div",i,[(0,a.QD)("nav",n,[(0,a.QD)("div",c,[(0,a.QD)("div",o,[(0,a.K2)(M,{class:"btn",to:{name:U.myDashboard}},{default:(0,a.Ql)((()=>[d])),_:1},8,["to"]),(0,a.QD)("h6",h,(0,r.WA)(s.title),1)]),(0,a.QD)("ul",p,[u,s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("li",f,y)):(0,a.g1)("",!0),s.filters&&s.filters.sortBys&&s.filters.sortBys.length?((0,a.Wz)(),(0,a.An)("li",g,v)):(0,a.g1)("",!0),(0,a.QD)("li",k,[(0,a.QD)("button",{class:"btn btn-outline-dark rounded-0 btn-sm px-1 py-0 ms-2",onClick:t[0]||(t[0]=(...e)=>U.updatePerPage&&U.updatePerPage(...e))},(0,r.WA)(m.perPage),1)])])])]),(0,a.QD)("div",D,[(0,a.QD)("div",S,[(0,a.wt)((0,a.QD)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>m.search=e),type:"search",class:"form-control rounded-0",placeholder:"Search Stocks",onChange:t[2]||(t[2]=(...e)=>U.emitFilters&&U.emitFilters(...e))},null,544),[[l.Og,m.search,void 0,{lazy:!0}]]),F])]),(0,a.QD)("div",Q,[(0,a.QD)("div",A,[U.isBrand?(0,a.wt)(((0,a.Wz)(),(0,a.An)("select",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>m.selectedParty=e),onChange:t[4]||(t[4]=(...e)=>U.applyFilters&&U.applyFilters(...e)),class:"form-select py-3 mb-3","aria-label":"Filter By Party"},[P,((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.parties,((e,t)=>((0,a.Wz)(),(0,a.An)("option",{key:t,value:e.sid},(0,r.WA)(e.name),9,x)))),128))],544)),[[l.Ip,m.selectedParty]]):(0,a.g1)("",!0),s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("p",w,"Filter by status")):(0,a.g1)("",!0),s.statuses&&s.statuses.length?((0,a.Wz)(),(0,a.An)("div",W,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.statuses,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{class:"flex-fill border-end border-bottom",key:t},[(0,a.QD)("input",{type:"checkbox",class:"btn-check",id:"filterby"+U.getCheckboxId(t),autocomplete:"off",value:e.value,checked:e.value===m.selectedStatus,onChange:t=>U.updateSelectedStatus(e.value)},null,40,z),(0,a.QD)("label",{class:"btn btn-outline-dark rounded-0 border-0 w-100",for:"filterby"+U.getCheckboxId(t)},(0,r.WA)(e.text),9,B),C])))),128))])):(0,a.g1)("",!0),(0,a.QD)("div",O,[(0,a.QD)("button",{onClick:t[5]||(t[5]=(...e)=>U.resetFilters&&U.resetFilters(...e)),class:"btn btn-outline-dark"},"Reset")])])]),(0,a.QD)("div",E,[m.localSortBys&&m.localSortBys.length?((0,a.Wz)(),(0,a.An)("div",$,[L,(0,a.QD)("div",_,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(m.localSortBys,((e,t)=>((0,a.Wz)(),(0,a.An)("div",{class:"flex-fill border-end",key:t},[(0,a.QD)("input",{type:"checkbox",class:"btn-check",id:"sortby"+U.getCheckboxId(t),autocomplete:"off",checked:e.selected,onChange:e=>U.updateSelectedSortBy(t)},null,40,I),(0,a.QD)("label",{class:"btn btn-outline-dark rounded-0 border-0 w-100",for:"sortby"+U.getCheckboxId(t)},(0,r.WA)((e.selected,e.name)),9,q),K])))),128))])])):(0,a.g1)("",!0)])])}var M={name:"OrderFilters",emits:["order-filter-updated"],props:{title:{type:String,default:"Products"},filters:{type:Object,default:()=>({})},parties:{type:Array,default:()=>[]},statuses:{type:Array,default:()=>[]}},data(){return{perPage:this.filters.perPage||10,search:this.filters.search||"",localSortBys:this.filters.sortBys?[...this.filters.sortBys]:[],selectedParty:this.filters.selectedParty||"",selectedStatus:this.filters.selectedStatus||""}},methods:{updatePerPage(){this.perPage>90?this.perPage=10:this.perPage+=10,this.applyFilters()},applyFilters(){this.$emit("order-filter-updated",{perPage:this.perPage,search:this.search,sortBys:this.localSortBys,selectedParty:this.selectedParty,selectedStatus:this.selectedStatus})},resetFilters(){this.perPage=10,this.search="",this.localSortBys=[...this.filters.sortBys],this.selectedParty="",this.selectedStatus="",this.applyFilters()},emitFilters(){this.applyFilters()},getCheckboxId(e){return`btn-check-outlined-${e}`},updateSelectedStatus(e){this.selectedStatus=this.selectedStatus===e?"":e,this.applyFilters()},updateSelectedSortBy(e){this.localSortBys=this.localSortBys.map(((t,s)=>(t.selected=s===e,t))),this.applyFilters()},capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}},computed:{isBrand(){return"brand"===this.$store.getters["authy/getPrefix"]},myDashboard(){const e=this.capitalizeFirstLetter(this.$store.getters["authy/getPrefix"]);return`${e}Dashboard`}}},N=s(4100);const T=(0,N.c)(M,[["render",U]]);var H=T},1256:function(e,t,s){s.d(t,{c:function(){return d}});var a=s(4108),r=s(9096);const l={class:"nav nav-pills nav-fill border-bottom"};function i(e,t,s,i,n,c){const o=(0,a.E1)("router-link");return(0,a.Wz)(),(0,a.An)("ul",l,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(s.links,(e=>((0,a.Wz)(),(0,a.An)("li",{class:"nav-item",key:e.name},[(0,a.K2)(o,{to:{name:e.name},class:(0,r.WN)(["nav-link rounded-0 fw-500 ls-1 small text-bg-light",{"active text-white":c.isLinkActive(e.name)}])},{default:(0,a.Ql)((()=>[(0,a.mY)((0,r.WA)(e.label),1)])),_:2},1032,["to","class"])])))),128))])}var n={name:"OrderTabs",props:{links:{type:Array,required:!0}},methods:{isLinkActive(e){return this.$route.name===e}}},c=s(4100);const o=(0,c.c)(n,[["render",i],["__scopeId","data-v-600df884"]]);var d=o},4040:function(e,t,s){s.d(t,{c:function(){return k}});var a=s(4108),r=s(7764);const l={class:"font-title"},i={key:0,class:"list-group list-group-flush"};function n(e,t,s,n,c,o){const d=(0,a.E1)("OrderFilters"),h=(0,a.E1)("OrderTabs"),p=(0,a.E1)("DispatchCard"),u=(0,a.E1)("DispatchDetails"),f=(0,a.E1)("DispatchStockIn"),b=(0,a.E1)("EmptyList");return(0,a.Wz)(),(0,a.An)("div",l,[(0,a.K2)(d,{title:c.title,filters:c.filters,parties:o.parties,statuses:o.statuses,onOrderFilterUpdated:o.handleFiltersChange},null,8,["title","filters","parties","statuses","onOrderFilterUpdated"]),(0,a.K2)(h,{links:s.links},null,8,["links"]),Object.keys(c.dispatches).length?((0,a.Wz)(),(0,a.An)("ul",i,[((0,a.Wz)(!0),(0,a.An)(a.ae,null,(0,a.mi)(c.dispatches,((e,t)=>((0,a.Wz)(),(0,a.An)("li",{class:"list-group-item p-0",key:t},[(0,a.K2)(r.Ox,{name:"slide",mode:"out-in"},{default:(0,a.Ql)((()=>[(0,a.K2)(p,{dispatch:e},null,8,["dispatch"])])),_:2},1024)])))),128)),(0,a.K2)(u,{dispatches:c.dispatches},null,8,["dispatches"]),(0,a.K2)(f,{dispatches:c.dispatches},null,8,["dispatches"])])):((0,a.Wz)(),(0,a.Az)(b,{key:1,title:"No Dispatch Available"}))])}s(3248),s(2168),s(5104),s(8312);var c=s(6376),o=s(9176),d=s(1256),h=s(9812),p=s(60),u=s(8328),f=s(4880),b=s(8656),y=s.n(b),g={name:"NewDispatchSection",props:{module:{type:String,required:!0},links:{type:Array,required:!0}},components:{DispatchCard:h.c,OrderTabs:d.c,EmptyList:o.c,DispatchDetails:u.c,OrderFilters:p.c,DispatchStockIn:f.c},data(){return{title:"New Dispatches",page:1,isFetching:!1,dispatches:[],filters:{date:"",search:"",selectedStatus:"pending",selectedParty:"",perPage:10,sortBys:[{name:"Latest Dispatch",selected:!0,value:"created_at",order:"desc"},{name:"Oldest Dispatch",selected:!1,value:"created_at",order:"asc"},{name:"Highest Quantity",selected:!1,value:"quantity",order:"desc"},{name:"Lowest Quantity",selected:!1,value:"quantity",order:"asc"}]}}},mounted(){window.addEventListener("scroll",this.handleScroll),this.$route.query&&this.$route.query.search&&(this.filters.search=this.$route.query.search||""),this.loadMore()},unmounted(){window.removeEventListener("scroll",this.handleScroll)},watch:{parties:{handler(e){if(e.length){let t=this.$store.getters["authy/getPrefix"];"factory"!==t&&"vendor"!==t||(this.selectedParty=e[0].sid)}},immediate:!0},storeDispatches:{handler(e){this.dispatches=e,this.page=1},immediate:!0},filters:{handler(){console.log("Filters changed"),this.page=1,this.dispatches=[],this.loadMore()},deep:!0}},computed:{parties(){if(this.dispatches&&!this.dispatches.length)return[];const e=this.dispatches,t={},s=[];return e&&e.forEach((e=>{const a=e.party.sid;t[a]||(s.push(e.party),t[a]=!0)})),s},statuses(){return[{text:"Dispatched",value:"pending"},{text:"Received",value:"received"}]},storeDispatches(){return this.$store.getters["brandy/dispatches"]}},methods:{handleScroll(){const{scrollTop:e,scrollHeight:t,clientHeight:s}=document.documentElement;s+e>=t-5&&this.loadMore()},loadMore(){if(this.isFetching)return;this.isFetching=!0;const e=new URLSearchParams({page:this.page,search:this.filters.search,status:this.filters.selectedStatus,party:this.filters.selectedParty}),t=this.filters.sortBys.find((e=>e.selected));t&&(e.append("sortby",t.value),e.append("sortorder",t.order)),c.c.get(`dispatches?${e}&perpage=${this.filters.perPage}`).then((e=>{"ok"===e.data.status?(this.dispatches=[...this.dispatches,...e.data.data.data],this.page++,this.isFetching=!1):"error"===e.data.status?(this.isFetching=!1,y().fire({icon:"error",title:"Oops...",text:e.data.message})):(this.isFetching=!1,y().fire({icon:"error",title:"Oops...",text:"Something went wrong! Please try again"}))})).catch((e=>{this.isFetching=!1,console.log(e)}))},handleFiltersChange(e){this.filters=e}}},m=s(4100);const v=(0,m.c)(g,[["render",n]]);var k=v}}]);
//# sourceMappingURL=4040.e0940032.js.map