"use strict";(self["webpackChunkwsgbrand_app_v1"]=self["webpackChunkwsgbrand_app_v1"]||[]).push([[1296],{1636:function(e,t,s){s.r(t),s.d(t,{default:function(){return O}});var r=s(4108);const a={key:0},i={key:0,class:"list-group list-group-flush"},l={key:1,class:"py-5"},d=(0,r.QD)("p",{class:"text-muted text-center bg-light my-2"}," No order found for the selected filters. ",-1),n=[d];function o(e,t,s,d,o,c){const h=(0,r.E1)("OrderFilters"),u=(0,r.E1)("OrderTabs"),p=(0,r.E1)("OrderCard"),f=(0,r.E1)("EmptyList"),y=(0,r.E1)("OrderDetails");return(0,r.Wz)(),(0,r.An)("div",null,[(0,r.K2)(h,{title:o.title,parties:c.parties,filters:o.filters,statuses:c.statuses,onOrderFilterUpdated:c.handleFiltersChange},null,8,["title","parties","filters","statuses","onOrderFilterUpdated"]),(0,r.K2)(u,{links:o.links},null,8,["links"]),o.orders&&o.orders.length?((0,r.Wz)(),(0,r.An)("div",a,[((0,r.Wz)(!0),(0,r.An)(r.ae,null,(0,r.mi)(c.filteredOrders,((e,t)=>((0,r.Wz)(),(0,r.An)("div",{key:t},[Object.keys(c.filteredOrders).length?((0,r.Wz)(),(0,r.An)("ul",i,[(0,r.K2)(p,{order:e,type:c.cardType},null,8,["order","type"])])):((0,r.Wz)(),(0,r.An)("div",l,n))])))),128))])):((0,r.Wz)(),(0,r.Az)(f,{key:1,title:"No Orders Available"})),(0,r.K2)(y,{orders:c.filteredOrders,type:c.cardType},null,8,["orders","type"])])}s(3248);var c=s(6376),h=s(9176),u=s(1256),p=s(5707),f=s(60),y=s(5352),g={name:"OrdersPage",components:{OrderTabs:u.c,OrderCard:p.c,EmptyList:h.c,OrderDetails:y.c,OrderFilters:f.c},data(){return{title:"Orders",page:1,isFetching:!1,orders:[],filters:{date:"",search:"",selectedParty:"",selectedStatus:"issued",sortBys:[{name:{on:"Latest Order",off:"Oldest Order"},selected:!0},{name:{on:"Nearest Delivery",off:"Furthest Delivery"},selected:!1},{name:{on:"Highest Quantity",off:"Lowest Quantity"},selected:!1}]},links:[{name:"BrandSaleOrders",label:"Wsg Orders"},{name:"BrandPurchaseOrders",label:"Party Orders"}]}},mounted(){this.loadMore(),window.addEventListener("scroll",this.handleScroll),window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},watch:{prefix:{handler(e){"brand"===e?(this.filters.selectedParty="",this.filters.selectedStatus="rejected"):"factory"!==e&&"vendor"!==e||(this.filters.selectedParty=this.parties[0].sid,this.filters.selectedStatus="issued")},immediate:!0}},computed:{cardType(){return"brand"===this.$store.getters["authy/getPrefix"]?"brand":"party"},statuses(){return[{text:"Issued",value:"issued"},{text:"Accepted",value:"accepted"},{text:"Rejected",value:"rejected"},{text:"Completed",value:"completed"}]},parties(){const e=this.orders,t={},s=[];return e&&e.forEach((e=>{const r=e.party_sid;t[r]||(s.push(e.party),t[r]=!0)})),s},filteredOrders(){let e=this.orders;if(this.filters.search){const t=this.filters.search.toLowerCase();e=e.filter((e=>{const s=e.tags.split(",");return s.some((e=>e.toLowerCase().includes(t.trim())))}))}return this.filters.selectedParty&&(e=e.filter((e=>e.party.sid===this.filters.selectedParty))),this.filters.selectedStatus&&(e=e.filter((e=>e.status===this.filters.selectedStatus))),e=this.filters.sortBys[0].selected?e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))):e.sort(((e,t)=>new Date(e.created_at)-new Date(t.created_at))),e=this.filters.sortBys[1].selected?e.sort(((e,t)=>new Date(t.expected_at)-new Date(e.expected_at))):e.sort(((e,t)=>new Date(e.expected_at)-new Date(t.expected_at))),e=this.filters.sortBys[2].selected?e.sort(((e,t)=>t.quantity-e.quantity)):e.sort(((e,t)=>e.quantity-t.quantity)),e},prefix(){return this.$store.getters["authy/getPrefix"]}},methods:{handleScroll(){const{scrollTop:e,scrollHeight:t,clientHeight:s}=document.documentElement;s+e>=t-5&&this.loadMore()},loadMore(){this.isFetching||(this.isFetching=!0,c.c.get(`orders?page=${this.page}`).then((e=>{"ok"===e.data.status?(this.orders=[...this.orders,...e.data.data.data],this.page++,this.isFetching=!1):"error"===e.data.status?(this.isFetching=!1,alert(e.data.message)):(this.isFetching=!1,alert("Something went wrong! Please try again"))})).catch((e=>{this.isFetching=!1,console.log(e),alert("Something went wrong! Please try again")})))},handleFiltersChange(e){this.filters=e}}},m=s(4100);const w=(0,m.c)(g,[["render",o]]);var O=w}}]);
//# sourceMappingURL=1296.8d9d909f.js.map