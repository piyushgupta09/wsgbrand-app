"use strict";(self["webpackChunkwsgbrand_app_v1"]=self["webpackChunkwsgbrand_app_v1"]||[]).push([[724],{8724:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var r=s(4108);const a={key:1},i={class:"list-group list-group-flush"};function l(e,t,s,l,d,n){const o=(0,r.E1)("OrderFilters"),c=(0,r.E1)("OrderTabs"),h=(0,r.E1)("OrderCard"),u=(0,r.E1)("EmptyList"),f=(0,r.E1)("OrderDetails");return(0,r.Wz)(),(0,r.An)("div",null,[(0,r.K2)(o,{title:d.title,filters:d.filters,statuses:n.statuses,onOrderFilterUpdated:n.handleFiltersChange},null,8,["title","filters","statuses","onOrderFilterUpdated"]),(0,r.K2)(c,{links:d.links},null,8,["links"]),"brand"===n.prefix?((0,r.Wz)(),(0,r.Az)(c,{key:0})):(0,r.g1)("",!0),Object.keys(n.filteredOrders).length?((0,r.Wz)(),(0,r.An)("div",a,[((0,r.Wz)(!0),(0,r.An)(r.ae,null,(0,r.mi)(n.filteredOrders,((e,t)=>((0,r.Wz)(),(0,r.An)("div",{key:t},[(0,r.QD)("ul",i,[(0,r.K2)(h,{order:e,type:n.prefix},null,8,["order","type"])])])))),128))])):((0,r.Wz)(),(0,r.Az)(u,{key:2,title:"No Orders Available, try adjusting filters"})),(0,r.K2)(f,{orders:n.filteredOrders,type:n.prefix},null,8,["orders","type"])])}var d=s(6376),n=s(9176),o=s(5707),c=s(4062),h=s(7680),u=s(5352),f={name:"OrdersPage",components:{OrderCard:o.c,EmptyList:n.c,OrderTabs:c.c,OrderDetails:u.c,OrderFilters:h.c},data(){return{title:"Wsg Orders",page:1,isFetching:!1,orders:[],filters:{date:"",search:"",selectedParty:"",selectedStatus:"accepted",sortBys:[{name:{on:"Latest Order",off:"Oldest Order"},selected:!0},{name:{on:"Nearest Delivery",off:"Furthest Delivery"},selected:!1},{name:{on:"Highest Quantity",off:"Lowest Quantity"},selected:!1}]},links:[{name:"BrandSaleOrders",label:"Wsg Orders"},{name:"BrandPurchaseOrders",label:"Party Orders"}]}},mounted(){this.loadMore(),window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},watch:{filters:{handler(e,t){e.selectedStatus===t.selectedStatus&&e.search===t.search||(this.page=1,this.orders=[],this.loadMore())},deep:!0}},computed:{statuses(){return[{text:"Issued",value:"issued"},{text:"Accepted",value:"accepted"},{text:"Rejected",value:"rejected"},{text:"Completed",value:"completed"}]},filteredOrders(){let e=this.orders;if(this.filters.search){const t=this.filters.search.toLowerCase();e=e.filter((e=>{const s=e.tags.split(",");return s.some((e=>e.toLowerCase().includes(t.trim())))}))}return this.filters.selectedStatus&&(e=e.filter((e=>e.status===this.filters.selectedStatus))),e=this.filters.sortBys[0].selected?e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))):e.sort(((e,t)=>new Date(e.created_at)-new Date(t.created_at))),e=this.filters.sortBys[1].selected?e.sort(((e,t)=>new Date(t.expected_at)-new Date(e.expected_at))):e.sort(((e,t)=>new Date(e.expected_at)-new Date(t.expected_at))),e=this.filters.sortBys[2].selected?e.sort(((e,t)=>t.quantity-e.quantity)):e.sort(((e,t)=>e.quantity-t.quantity)),e},prefix(){return this.$store.getters["authy/getPrefix"]}},methods:{handleScroll(){const{scrollTop:e,scrollHeight:t,clientHeight:s}=document.documentElement;s+e>=t-5&&this.loadMore()},loadMore(){this.isFetching||(this.isFetching=!0,d.c.get(`orders?page=${this.page}&status=${this.filters.selectedStatus}&search=${this.filters.search}`).then((e=>{"ok"===e.data.status?(this.orders=[...this.orders,...e.data.data.data],this.page++,this.isFetching=!1):"error"===e.data.status?(this.isFetching=!1,alert(e.data.message)):(this.isFetching=!1,alert("Something went wrong! Please try again"))})).catch((e=>{this.isFetching=!1,console.log(e),alert("Something went wrong! Please try again")})))},handleFiltersChange(e){this.filters=e}}},p=s(4100);const g=(0,p.c)(f,[["render",l]]);var y=g}}]);
//# sourceMappingURL=724.a93d71d5.js.map